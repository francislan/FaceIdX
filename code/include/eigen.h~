#ifndef EIGEN_H
#define EIGEN_H

// error checking for CUDA calls: use this around ALL your calls!
#define GPU_CHECKERROR(err) (gpuCheckError(err, __FILE__, __LINE__ ))
static void gpuCheckError(cudaError_t err,
                         const char *file,
                         int line ) {
    if (err != cudaSuccess) {
        printf("%s in %s at line %d\n", cudaGetErrorString(err),
                file, line );
        exit(EXIT_FAILURE);
    }
}



struct Image * compute_average_cpu(struct Dataset * dataset);
struct Image * compute_average_gpu(struct Dataset * dataset);
//__global__ void compute_average_gpu_kernel(struct Dataset * dataset, struct Image * average);
__global__ void compute_average_gpu_kernel(unsigned char **images, int w, int h, int comp, int num_image);

#endif
